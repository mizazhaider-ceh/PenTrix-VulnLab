{% extends 'base.html' %}
{% block title %}XML Import{% endblock %}

{% block content %}
<div class="page-header animate-in">
    <h1 class="text-gradient">XML Import</h1>
    <p>Import and parse XML documents</p>
</div>

<div class="card animate-in" style="animation-delay:0.05s;">
    <div class="card-header">
        <h3 style="display:flex;align-items:center;gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
            XML Parser
        </h3>
    </div>
    <div class="card-body">
        <form method="POST" action="/tools/xml-import" id="xml-form">
            <div class="form-group">
                <label for="xml_data">XML Data</label>
                <textarea id="xml_data" name="xml_data" class="form-control" rows="10" style="font-family:'JetBrains Mono',monospace;font-size:0.88rem;" placeholder='<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<data>&xxe;</data>'>{{ xml_data or '' }}</textarea>
            </div>
            <button type="submit" class="btn btn-primary" style="display:flex;align-items:center;gap:6px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
                Parse XML
            </button>
        </form>
    </div>
</div>

{% if result %}
<div class="card mt-2 animate-in" style="animation-delay:0.1s;">
    <div class="card-header">
        <h3 style="display:flex;align-items:center;gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--info)" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
            Parsed Result
        </h3>
    </div>
    <div class="card-body">
        <div class="tool-output" style="font-family:'JetBrains Mono',monospace;font-size:0.88rem;padding:16px;background:rgba(0,0,0,0.25);border-radius:8px;border:1px solid rgba(255,255,255,0.04);white-space:pre-wrap;">{{ result }}</div>
    </div>
</div>
{% endif %}

<div class="card mt-2 animate-in" style="animation-delay:0.15s;">
    <div class="card-header">
        <h3 style="display:flex;align-items:center;gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            Also Available
        </h3>
    </div>
    <div class="card-body">
        <p style="color:var(--text-secondary);">SOAP Endpoint: <code style="background:rgba(167,139,250,0.12);color:#a78bfa;padding:2px 6px;border-radius:4px;">POST /tools/soap</code></p>
        <p style="color:var(--text-secondary);margin-top:6px;">XInclude: <code style="background:rgba(167,139,250,0.12);color:#a78bfa;padding:2px 6px;border-radius:4px;">POST /tools/xinclude</code></p>
    </div>
</div>

<div class="card mt-2 animate-in" style="animation-delay:0.2s;">
    <div class="card-body" style="display:flex;align-items:flex-start;gap:12px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--info)" stroke-width="2" style="flex-shrink:0;margin-top:2px;"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        <div>
            <strong style="color:var(--text-primary);">Hint:</strong>
            <span style="color:var(--text-secondary);">XML external entities (XXE) are enabled. Try defining an external entity to read system files.</span>
        </div>
    </div>
</div>
{% endblock %}

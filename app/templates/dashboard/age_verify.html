{% extends 'base.html' %}
{% block title %}Age Verification{% endblock %}

{% block content %}
<div class="page-header animate-in">
    <h1 class="text-gradient">Age Verification Required</h1>
    <p>You must be 18 or older to access restricted content</p>
</div>

<div class="card animate-in" style="animation-delay:0.05s;">
    <div class="card-header">
        <h3 style="display:flex; align-items:center; gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            Verify Your Age
        </h3>
    </div>
    <div class="card-body" style="text-align:center; padding:48px 24px;">
        <div style="font-size:3rem; margin-bottom:16px;"><svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="1.5" style="opacity:0.6;"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
        <p style="font-size:1.15rem; margin-bottom:28px; color:var(--text-secondary);">
            Are you <strong style="color:var(--text-primary);">18 years of age</strong> or older?
        </p>
        
        <!-- [VULN: CH13-C07] Client-side only age verification -->
        <!-- The server only checks if age_verified=true is sent -->
        <form id="ageForm" method="POST" action="/age-verify/confirmed">
            <input type="hidden" name="age_verified" id="ageField" value="false">
            
            <div style="display:flex; gap:16px; justify-content:center;">
                <button type="button" class="btn btn-primary" onclick="confirmAge(true)" style="padding:14px 40px; font-size:1rem; display:flex; align-items:center; gap:8px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                    Yes, I am 18+
                </button>
                <button type="button" class="btn" onclick="confirmAge(false)" style="padding:14px 40px; font-size:1rem; display:flex; align-items:center; gap:8px; border-color:var(--danger); color:var(--danger);">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
                    No, under 18
                </button>
            </div>
        </form>
        
        <div id="result" style="margin-top:24px; display:none;">
            <div class="flash flash-error" id="resultAlert"></div>
        </div>
    </div>
</div>

<script>
// [VULN: CH13-C07] Client-side verification â€” easily bypassed
function confirmAge(isAdult) {
    if (isAdult) {
        document.getElementById('ageField').value = 'true';
        document.getElementById('ageForm').submit();
    } else {
        var result = document.getElementById('result');
        var alert = document.getElementById('resultAlert');
        result.style.display = 'block';
        alert.innerHTML = '<strong>Access Denied</strong><br>You must be 18 or older to continue.';
    }
}
</script>
{% endblock %}

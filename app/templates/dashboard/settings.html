{% extends 'base.html' %}
{% block title %}Settings{% endblock %}

{% block content %}
<div class="page-header animate-in">
    <h1 class="text-gradient">Account Settings</h1>
    <p>Manage your account preferences and security</p>
</div>

{% if debug_mode == 'true' %}
<!-- [VULN: CH07-C02] Debug mode exposed via ?debug=true -->
<div class="flash flash-error animate-in" style="animation-delay:0.03s;">
    <strong>Debug Mode Active</strong>
    <pre style="margin:8px 0; padding:12px; background:rgba(0,0,0,0.2); border-radius:var(--radius); overflow-x:auto;">{{ debug_flag }}</pre>
    <p style="color:var(--text-muted); font-size:0.85rem;">Debug information is being displayed because debug=true parameter is set.</p>
    <pre style="margin:8px 0; padding:12px; background:rgba(0,0,0,0.2); border-radius:var(--radius); overflow-x:auto; font-size:0.82rem;">
Application Config:
  DEBUG: True
  SECRET_KEY: super_secret_key_12345
  DATABASE: sqlite:////app/data/pentrix.db
  FLASK_ENV: development
  INTERNAL_SERVICE: http://internal:8080
  REDIS_URL: redis://redis:6379/0
    </pre>
</div>
{% endif %}

<div class="card animate-in" style="animation-delay:0.05s;">
    <div class="card-header">
        <h3 style="display:flex; align-items:center; gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            Profile Settings
        </h3>
    </div>
    <div class="card-body">
        <form method="POST" action="/profile/{{ session.get('user_id', 1) }}/update">
            <div class="form-group">
                <label>Display Name</label>
                <input type="text" name="display_name" class="form-control" placeholder="Your display name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" class="form-control" placeholder="your@email.com">
            </div>
            <div class="form-group">
                <label>Bio</label>
                <textarea name="bio" class="form-control" rows="3" placeholder="Tell us about yourself..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Save Changes</button>
        </form>
    </div>
</div>

<div class="card mt-2 animate-in" style="animation-delay:0.1s;">
    <div class="card-header">
        <h3 style="display:flex; align-items:center; gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            Change Password
        </h3>
    </div>
    <div class="card-body">
        <form method="POST" action="/account/password">
            <div class="form-group">
                <label>Current Password</label>
                <input type="password" name="current_password" class="form-control">
            </div>
            <div class="form-group">
                <label>New Password</label>
                <input type="password" name="new_password" class="form-control">
            </div>
            <div class="form-group">
                <label>Confirm New Password</label>
                <input type="password" name="confirm_password" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">Update Password</button>
        </form>
    </div>
</div>

<div class="card mt-2 animate-in" style="animation-delay:0.15s;">
    <div class="card-header">
        <h3 style="display:flex; align-items:center; gap:8px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
            Notifications
        </h3>
    </div>
    <div class="card-body">
        <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
            <input type="checkbox" checked style="width:auto;"> Email notifications
        </label>
        <label style="display:flex; align-items:center; gap:8px; margin-top:10px; cursor:pointer;">
            <input type="checkbox" checked style="width:auto;"> Message alerts
        </label>
        <label style="display:flex; align-items:center; gap:8px; margin-top:10px; cursor:pointer;">
            <input type="checkbox" style="width:auto;"> Developer mode
        </label>
    </div>
</div>

<!-- Hint: Try adding ?debug=true to the URL -->
{% endblock %}
